<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BongoWide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        // --- TAILWIND CONFIGURATION & THEME LOGIC ---
        
        // 1. Theme State (Default)
        const themeConfig = {
            mode: localStorage.getItem('theme-mode') || 'light', // 'light' or 'dark'
            color: localStorage.getItem('theme-color') || 'blue-600', // Default color
        };

        // Rangi zilizopo za kuchagua (kama picha ulivyotuma)
        const colorOptions = [
            'blue-600', 'green-500', 'purple-600', 'orange-500', 'red-600'
        ];

        // Function ya ku-resolve color class
        function getColorClass(color) {
            switch(color) {
                case 'green-500': return '#22c55e';
                case 'purple-600': return '#9333ea';
                case 'orange-500': return '#f97316';
                case 'red-600': return '#dc2626';
                default: return '#2563eb'; // blue-600
            }
        }

        // 2. Dynamic Tailwind Config
        tailwind.config = {
            darkMode: 'class', // We use the 'dark' class on the HTML tag
            theme: {
                extend: {
                    colors: {
                        border: "hsl(var(--border))",
                        input: "hsl(var(--input))",
                        ring: "hsl(var(--ring))",
                        background: "hsl(var(--background))",
                        foreground: "hsl(var(--foreground))",
                        // Primary color uses the dynamic theme color
                        primary: {
                            DEFAULT: getColorClass(themeConfig.color),
                            foreground: "#ffffff",
                        },
                        secondary: {
                            DEFAULT: "#f1f5f9",
                            foreground: "#0f172a",
                        },
                        // Custom dark mode colors (Maboresho ya Dark Mode)
                        'dark-bg': '#111827',
                        'dark-surface': '#1f2937',
                        'dark-text': '#f3f4f6',
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom Scrollbar hide */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Body default state */
        body { background-color: #f8fafc; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        .auth-container { background-color: #f8fafc; }

        /* Dark Mode overrides */
        .dark body { background-color: #111827; color: #f3f4f6; }
        .dark .bg-white { background-color: #1f2937 !important; color: #f3f4f6; }
        .dark .border-b, .dark .divide-y { border-color: #374151 !important; }
        .dark .text-slate-900 { color: #f3f4f6 !important; }
        .dark .text-slate-500, .dark .text-slate-600 { color: #9ca3af !important; }
        .dark .hover\:bg-slate-100:hover { background-color: #374158 !important; }
        .dark .bg-slate-50 { background-color: #111827 !important; }
        .dark .bg-slate-200 { background-color: #374151 !important; }
        .dark .shadow-sm { box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.2); }
    </style>
</head>

<body class="text-slate-900">

    <header id="app-header" class="flex h-16 shrink-0 items-center justify-between border-b bg-white px-4 shadow-sm z-10 hidden">
        <h1 class="text-2xl font-bold text-primary-DEFAULT">BongoWide</h1>
        <div class="flex items-center gap-2">
            <button class="p-2 rounded-full hover:bg-slate-100 text-slate-600">
                <i class="fas fa-bell text-lg"></i>
            </button>
            <button class="p-2 rounded-full hover:bg-slate-100 text-slate-600" id="search-btn">
                <i class="fas fa-search text-lg"></i>
            </button>
            <button id="theme-toggle-btn" class="p-2 rounded-full hover:bg-slate-100 text-slate-600 relative">
                <i class="fas fa-adjust text-lg"></i> 
            </button>
            <button onclick="switchTab('Settings')" class="ml-1 h-8 w-8 rounded-full bg-slate-200 overflow-hidden border border-slate-300">
                <img src="https://i.pravatar.cc/150?u=me" alt="User" class="h-full w-full object-cover">
            </button>
        </div>
    </header>

    <main id="app-content" class="flex-1 overflow-hidden relative auth-container">
    </main>

    <nav id="app-nav" class="flex h-16 items-center justify-around border-t bg-white z-10 hidden">
        <button onclick="switchTab('Chats')" id="nav-Chats" class="nav-btn flex h-full flex-1 flex-col items-center justify-center gap-1 text-xs text-slate-500 hover:text-primary-DEFAULT transition-colors">
            <i class="fas fa-comment-alt text-xl mb-1"></i>
            <span>Chats</span>
        </button>
        <button onclick="switchTab('Updates')" id="nav-Updates" class="nav-btn flex h-full flex-1 flex-col items-center justify-center gap-1 text-xs text-slate-500 hover:text-primary-DEFAULT transition-colors">
            <i class="fas fa-rss text-xl mb-1"></i>
            <span>Updates</span>
        </button>
        <button onclick="switchTab('Groups')" id="nav-Groups" class="nav-btn flex h-full flex-1 flex-col items-center justify-center gap-1 text-xs text-slate-500 hover:text-primary-DEFAULT transition-colors">
            <i class="fas fa-users text-xl mb-1"></i>
            <span>Groups</span>
        </button>
        <button onclick="switchTab('World')" id="nav-World" class="nav-btn flex h-full flex-1 flex-col items-center justify-center gap-1 text-xs text-slate-500 hover:text-primary-DEFAULT transition-colors">
            <i class="fas fa-globe text-xl mb-1"></i>
            <span>World</span>
        </button>
        <button onclick="switchTab('Calls')" id="nav-Calls" class="nav-btn flex h-full flex-1 flex-col items-center justify-center gap-1 text-xs text-slate-500 hover:text-primary-DEFAULT transition-colors">
            <i class="fas fa-phone text-xl mb-1"></i>
            <span>Calls</span>
        </button>
    </nav>
    
    <div id="theme-modal" class="absolute top-16 right-4 z-50 hidden">
        </div>


    <script>
        // --- MOCK DATA ---
        
        const mockChats = [
            { id: 1, name: "Juma Jux", type: 'private', avatarUrl: "https://i.pravatar.cc/150?u=1", unreadCount: 2, messages: [{ text: "Mambo vipi kaka?", timestamp: "10:30 AM" }] },
            { id: 2, name: "Wazee wa Bongo", type: 'group', avatarUrl: "https://i.pravatar.cc/150?u=2", unreadCount: 0, messages: [{ text: "Kikao kipo leo?", timestamp: "Yesterday" }] },
            { id: 3, name: "Anita", type: 'private', avatarUrl: "https://i.pravatar.cc/150?u=3", unreadCount: 5, messages: [{ text: "Call me ASAP", timestamp: "Yesterday" }] },
            { id: 4, name: "Tech Talk TZ", type: 'group', avatarUrl: "https://i.pravatar.cc/150?u=4", unreadCount: 10, messages: [{ text: "New React version released", timestamp: "2 days ago" }] }
        ];

        const mockWorldPosts = [
            { id: 1, imageUrl: "https://picsum.photos/400/400?random=1", caption: "Sunset in Zanzibar", user: { name: "Asha" } },
            { id: 2, imageUrl: "https://picsum.photos/400/400?random=2", caption: "Coding setup", user: { name: "DevBaraka" } },
            { id: 3, imageUrl: "https://picsum.photos/400/400?random=3", caption: "Simba vs Yanga", user: { name: "FanBot" } },
        ];

        const mockCalls = [
            { id: 1, user: { name: "Mama", avatarUrl: "https://i.pravatar.cc/150?u=5" }, type: 'incoming', isVideo: false, timestamp: "Today, 10:00 AM" },
            { id: 2, user: { name: "Job", avatarUrl: "https://i.pravatar.cc/150?u=6" }, type: 'missed', isVideo: true, timestamp: "Yesterday, 8:30 PM" },
        ];

        const mockStatusUpdates = [
            { id: 1, viewed: false, user: { name: "Ben", avatarUrl: "https://i.pravatar.cc/150?u=7" } },
            { id: 2, viewed: true, user: { name: "Alice", avatarUrl: "https://i.pravatar.cc/150?u=8" } },
        ];


        // --- AUTH SCREEN RENDERERS (Zimefupishwa kwa ufupi) ---

        function getSignInScreen() {
            return `
                <div class="flex flex-col items-center justify-center h-full p-8 text-center bg-white sm:bg-transparent dark:bg-dark-bg">
                    <i class="fas fa-lock text-5xl text-primary-DEFAULT mb-6"></i>
                    <h2 class="text-3xl font-bold mb-2 text-slate-900 dark:text-dark-text">Karibu Tena</h2>
                    <p class="text-slate-500 mb-8 dark:text-gray-400">Ingia ili kuendelea na BongoWide.</p>

                    <form class="w-full max-w-sm space-y-4">
                        <input type="email" placeholder="Barua pepe" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-DEFAULT focus:border-primary-DEFAULT dark:bg-dark-surface dark:border-gray-700">
                        <input type="password" placeholder="Neno Siri" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-DEFAULT focus:border-primary-DEFAULT dark:bg-dark-surface dark:border-gray-700">
                        
                        <button type="button" onclick="loginSuccess()" class="w-full bg-primary-DEFAULT text-white py-3 rounded-lg font-semibold shadow-md hover:opacity-90 transition-colors active:scale-95">
                            Ingia
                        </button>
                    </form>

                    <button onclick="showAuthScreen('SignUp')" class="mt-6 text-sm text-primary-DEFAULT hover:opacity-80 transition-colors">
                        Huna akaunti? Jisajili hapa
                    </button>
                </div>
            `;
        }

        function getSignUpScreen() {
            return `
                <div class="flex flex-col items-center justify-center h-full p-8 text-center bg-white sm:bg-transparent dark:bg-dark-bg">
                    <i class="fas fa-user-plus text-5xl text-primary-DEFAULT mb-6"></i>
                    <h2 class="text-3xl font-bold mb-2 text-slate-900 dark:text-dark-text">Fungua Akaunti</h2>
                    <p class="text-slate-500 mb-8 dark:text-gray-400">Jisajili ili kuanza kutumia BongoWide.</p>

                    <form class="w-full max-w-sm space-y-4">
                        <input type="text" placeholder="Jina Kamili" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-DEFAULT focus:border-primary-DEFAULT dark:bg-dark-surface dark:border-gray-700">
                        <input type="email" placeholder="Barua pepe" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-DEFAULT focus:border-primary-DEFAULT dark:bg-dark-surface dark:border-gray-700">
                        <input type="password" placeholder="Neno Siri" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-DEFAULT focus:border-primary-DEFAULT dark:bg-dark-surface dark:border-gray-700">
                        
                        <button type="button" onclick="loginSuccess()" class="w-full bg-primary-DEFAULT text-white py-3 rounded-lg font-semibold shadow-md hover:opacity-90 transition-colors active:scale-95">
                            Jisajili
                        </button>
                    </form>

                    <button onclick="showAuthScreen('SignIn')" class="mt-6 text-sm text-primary-DEFAULT hover:opacity-80 transition-colors">
                        Tayari unayo akaunti? Ingia
                    </button>
                </div>
            `;
        }


        // --- NEW: SETTINGS SCREEN RENDERER (Kama picha ya pili) ---

        function getSettingsScreen() {
            const userProfile = { name: "Kelvin Charles", avatarUrl: "https://i.pravatar.cc/150?u=me" };

            const settingsItems = [
                { icon: 'fas fa-key', title: 'Account', subtitle: 'Security notifications, change number', action: 'account' },
                { icon: 'fas fa-lock', title: 'Privacy', subtitle: 'Block contacts, disappearing messages', action: 'privacy' },
                { icon: 'fas fa-smile', title: 'Avatar', subtitle: 'Create, edit, profile photo', action: 'avatar' },
                { icon: 'fas fa-comment-dots', title: 'Chats', subtitle: 'Theme, wallpapers, chat history', action: 'chats' },
                { icon: 'fas fa-bell', title: 'Notifications', subtitle: 'Message, group & call tones', action: 'notifications' },
                { icon: 'fas fa-database', title: 'Storage and data', subtitle: 'Network usage, auto-download', action: 'storage' },
                { icon: 'fas fa-sign-out-alt text-red-500', title: 'Logout', isLogout: true, action: 'logout' },
            ];

            const settingsHtml = settingsItems.map(item => `
                <div onclick="${item.isLogout ? 'alert(\'Logging out...\')' : 'alert(\'Go to ' + item.title + '\')'}" class="flex items-center gap-4 p-4 transition-colors hover:bg-slate-100 dark:hover:bg-dark-surface cursor-pointer">
                    <div class="w-8 h-8 flex items-center justify-center text-xl text-primary-DEFAULT dark:text-primary-DEFAULT">
                        <i class="${item.icon} ${item.isLogout ? 'text-red-500' : ''}"></i>
                    </div>
                    <div class="flex-1 overflow-hidden">
                        <h3 class="font-medium ${item.isLogout ? 'text-red-500' : 'text-slate-900 dark:text-dark-text'}">${item.title}</h3>
                        ${item.subtitle ? `<p class="text-sm text-slate-500 dark:text-gray-400">${item.subtitle}</p>` : ''}
                    </div>
                    ${!item.isLogout ? '<i class="fas fa-chevron-right text-slate-400 text-sm"></i>' : ''}
                </div>
            `).join('');


            return `
                <div class="h-full overflow-y-auto bg-slate-50 dark:bg-dark-bg">
                    <header class="h-16 flex items-center px-4 bg-white dark:bg-dark-surface border-b border-slate-100 dark:border-gray-700">
                        <button onclick="switchTab('Chats')" class="p-2 mr-4 text-slate-600 dark:text-gray-400 hover:bg-slate-100 dark:hover:bg-dark-surface rounded-full">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <h2 class="text-xl font-semibold text-slate-900 dark:text-dark-text">Settings</h2>
                    </header>
                    
                    <div class="flex items-center gap-4 p-4 mt-2 bg-white dark:bg-dark-surface border-b border-t border-slate-100 dark:border-gray-700 cursor-pointer hover:bg-slate-100 dark:hover:bg-dark-surface">
                        <div class="h-14 w-14 rounded-full bg-slate-200 overflow-hidden border border-slate-300">
                            <img src="${userProfile.avatarUrl}" alt="${userProfile.name}" class="h-full w-full object-cover">
                        </div>
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-slate-900 dark:text-dark-text">${userProfile.name}</h3>
                            <p class="text-sm text-slate-500 dark:text-gray-400">Hey there! I'm using BongoWide.</p>
                        </div>
                        <i class="fas fa-qrcode text-primary-DEFAULT text-2xl"></i>
                    </div>

                    <div class="bg-white dark:bg-dark-surface divide-y divide-slate-100 dark:divide-gray-700 mt-4 shadow-sm pb-12">
                        ${settingsHtml}
                    </div>

                </div>
            `;
        }

        // --- APP SCREEN RENDERERS (Updated to use primary-DEFAULT) ---

        function getChatsScreen() {
            const chatsHtml = mockChats.map(chat => `
                <div class="flex items-center gap-4 p-4 transition-colors hover:bg-white dark:hover:bg-dark-surface cursor-pointer">
                    <div class="relative">
                        <img src="${chat.avatarUrl}" alt="${chat.name}" class="h-12 w-12 rounded-full object-cover">
                    </div>
                    <div class="flex-1 overflow-hidden">
                        <h3 class="truncate font-semibold text-slate-900 dark:text-dark-text">${chat.name}</h3>
                        <p class="truncate text-sm text-slate-500 dark:text-gray-400">
                            ${chat.messages[0]?.text || "No messages"}
                        </p>
                    </div>
                    <div class="flex flex-col items-end gap-1 text-xs text-slate-500 dark:text-gray-400">
                        <span>${chat.messages[0]?.timestamp || ""}</span>
                        ${chat.unreadCount > 0 ? `<span class="bg-primary-DEFAULT text-white px-2 py-0.5 rounded-full text-[10px]">${chat.unreadCount}</span>` : ''}
                    </div>
                </div>
            `).join('');

            return `
                <div class="relative h-full bg-white dark:bg-dark-surface">
                    <div class="h-full overflow-y-auto divide-y divide-slate-100 dark:divide-gray-700 pb-20">
                        ${chatsHtml}
                    </div>
                    <button class="absolute bottom-6 right-6 h-14 w-14 rounded-full shadow-lg bg-primary-DEFAULT text-white flex items-center justify-center hover:opacity-90 transition-transform active:scale-95">
                        <i class="fas fa-comment-medical text-xl"></i>
                    </button>
                </div>
            `;
        }

        function getWorldScreen() {
            const postsHtml = mockWorldPosts.map(post => `
                <div class="relative group overflow-hidden rounded-lg bg-slate-200 aspect-square cursor-pointer">
                    <img src="${post.imageUrl}" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                    <div class="absolute bottom-0 left-0 p-2 text-white">
                        <p class="text-xs font-semibold truncate">${post.caption}</p>
                        <p class="text-xs text-white/80">by ${post.user.name}</p>
                    </div>
                </div>
            `).join('');

            return `
                <div class="h-full overflow-y-auto p-2 bg-slate-50 dark:bg-dark-bg">
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 pb-20">
                        ${postsHtml}
                    </div>
                </div>
            `;
        }

        // Other screen renderers (Groups, Updates, Calls) pia zinahitaji kurekebishwa kutumia dark mode na primary-DEFAULT. Zimeachwa kwa ufupi kuepuka msimbo mrefu sana.

        // --- CORE APP LOGIC ---

        function toggleAppUI(show) {
            const header = document.getElementById('app-header');
            const nav = document.getElementById('app-nav');
            const main = document.getElementById('app-content');

            if (show) {
                header.classList.remove('hidden');
                nav.classList.remove('hidden');
                main.classList.remove('auth-container');
                main.classList.add('bg-slate-50');
            } else {
                header.classList.add('hidden');
                nav.classList.add('hidden');
                main.classList.add('auth-container');
                main.classList.remove('bg-slate-50');
            }
        }

        function showAuthScreen(screenName) {
            toggleAppUI(false); 
            const container = document.getElementById('app-content');
            
            switch(screenName) {
                case 'SignIn':
                    container.innerHTML = getSignInScreen();
                    break;
                case 'SignUp':
                    container.innerHTML = getSignUpScreen();
                    break;
            }
        }

        function loginSuccess() {
            toggleAppUI(true); 
            switchTab('Chats');
            alert('Umefanikiwa kuingia! Karibu BongoWide.');
        }

        function switchTab(tabName) {
            const container = document.getElementById('app-content');
            const navButtons = document.querySelectorAll('.nav-btn');
            
            // Ficha navigation kwa skrini zisizo za App za kawaida (mfano Settings)
            if (tabName === 'Settings') {
                document.getElementById('app-nav').classList.add('hidden');
                document.getElementById('app-header').classList.add('hidden'); // Ficha header pia
                container.innerHTML = getSettingsScreen();
                return;
            } else {
                document.getElementById('app-nav').classList.remove('hidden');
                document.getElementById('app-header').classList.remove('hidden');
            }


            navButtons.forEach(btn => {
                const icon = btn.querySelector('i');
                if(btn.id === `nav-${tabName}`) {
                    btn.classList.add('text-primary-DEFAULT');
                    btn.classList.remove('text-slate-500');
                    // Kuweka icon kuwa solid kwa tab iliyochaguliwa (Mfano: fas fa-comment-alt-solid)
                    if (tabName === 'Chats') icon.classList.remove('far'); // mfano
                } else {
                    btn.classList.remove('text-primary-DEFAULT');
                    btn.classList.add('text-slate-500');
                }
            });

            // Inject Content based on Tab
            switch(tabName) {
                case 'Chats':
                    container.innerHTML = getChatsScreen();
                    break;
                case 'Updates':
                    // container.innerHTML = getUpdatesScreen();
                    container.innerHTML = '<h2>Updates Screen (TODO)</h2>';
                    break;
                case 'Groups':
                    // container.innerHTML = getGroupsScreen();
                    container.innerHTML = '<h2>Groups Screen (TODO)</h2>';
                    break;
                case 'World':
                    container.innerHTML = getWorldScreen();
                    break;
                case 'Calls':
                    // container.innerHTML = getCallsScreen();
                    container.innerHTML = '<h2>Calls Screen (TODO)</h2>';
                    break;
            }
        }

        // --- NEW: THEME LOGIC ---

        function applyTheme() {
            // Apply Mode
            if (themeConfig.mode === 'dark') {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            localStorage.setItem('theme-mode', themeConfig.mode);

            // Apply Color
            const newColor = getColorClass(themeConfig.color);
            document.documentElement.style.setProperty('--tw-primary-color', newColor);
            
            // Hii inatumika ku-refresh Tailwind Config. Kwa dev environment kama hivi, 
            // lazima tu-reload ukurasa au tuingize style mpya moja kwa moja, 
            // Lakini kwa kuwa tulitumia `getColorClass` kwenye config awali, 
            // tutaweka style moja kwa moja kupitia CSS Variable kwa uhakika zaidi.
            
            // Replace dynamic color uses (Header Title and Icons)
            const root = document.querySelector(':root');
            root.style.setProperty('--tw-primary-color', newColor);
            
            // Update the header title and nav buttons (Quick fix for live color update)
            const headerTitle = document.querySelector('#app-header h1');
            if (headerTitle) headerTitle.style.color = newColor;

            document.querySelectorAll('.nav-btn.text-primary-DEFAULT').forEach(btn => {
                btn.style.color = newColor;
            });

            localStorage.setItem('theme-color', themeConfig.color);

            // Trigger a re-render of the current tab content to pick up the new Tailwind classes
            const currentActiveButton = document.querySelector('.nav-btn.text-primary-DEFAULT');
            if (currentActiveButton && currentActiveButton.id) {
                const tabName = currentActiveButton.id.replace('nav-', '');
                switchTab(tabName);
            }
        }


        // Kazi ya kubadili Mode (Light/Dark)
        function setMode(mode) {
            themeConfig.mode = mode;
            applyTheme();
        }

        // Kazi ya kubadili Rangi
        function setColor(color) {
            themeConfig.color = color;
            applyTheme();
        }

        // Kazi ya kuonyesha/kuficha Theme Modal
        function handleThemeToggle() {
            const modal = document.getElementById('theme-modal');
            const themeBtn = document.getElementById('theme-toggle-btn');
            
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                modal.innerHTML = getThemeModalHtml();
                // Close when clicking outside
                document.addEventListener('click', closeThemeModalOutside);
            } else {
                modal.classList.add('hidden');
                document.removeEventListener('click', closeThemeModalOutside);
            }
        }

        function closeThemeModalOutside(event) {
            const modal = document.getElementById('theme-modal');
            const themeBtn = document.getElementById('theme-toggle-btn');

            if (!modal.contains(event.target) && !themeBtn.contains(event.target)) {
                modal.classList.add('hidden');
                document.removeEventListener('click', closeThemeModalOutside);
            }
        }

        // HTML kwa ajili ya Theme Modal (Kama picha uliyonitumia)
        function getThemeModalHtml() {
            const colorButtons = colorOptions.map(color => `
                <button 
                    onclick="setColor('${color}'); event.stopPropagation();" 
                    class="w-8 h-8 rounded-full bg-${color.replace('-600', '-500')}"
                    style="background-color: ${getColorClass(color)};"
                >
                    ${themeConfig.color === color ? '<i class="fas fa-check text-white text-xs"></i>' : ''}
                </button>
            `).join('');

            return `
                <div class="w-64 bg-white dark:bg-dark-surface shadow-xl rounded-lg p-4 border border-slate-200 dark:border-gray-700">
                    <h3 class="font-semibold mb-4 text-slate-900 dark:text-dark-text">Mode</h3>
                    <div class="flex justify-between items-center mb-6">
                        <button onclick="setMode('light'); event.stopPropagation();" class="flex-1 flex items-center justify-center p-2 rounded-lg ${themeConfig.mode === 'light' ? 'bg-slate-200 dark:bg-dark-surface border border-slate-300 dark:border-gray-600' : 'hover:bg-slate-100 dark:hover:bg-dark-surface'}">
                            <i class="fas fa-sun text-lg mr-2"></i> Light
                        </button>
                        <button onclick="setMode('dark'); event.stopPropagation();" class="flex-1 flex items-center justify-center p-2 ml-2 rounded-lg ${themeConfig.mode === 'dark' ? 'bg-slate-200 dark:bg-dark-surface border border-slate-300 dark:border-gray-600' : 'hover:bg-slate-100 dark:hover:bg-dark-surface'}">
                            <i class="fas fa-moon text-lg mr-2"></i> Dark
                        </button>
                    </div>

                    <h3 class="font-semibold mb-4 text-slate-900 dark:text-dark-text">Color</h3>
                    <div class="flex justify-between">
                        ${colorButtons}
                    </div>
                </div>
            `;
        }

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            // Apply theme on load
            applyTheme();
            
            // Set the event listener for the theme button
            document.getElementById('theme-toggle-btn').addEventListener('click', (event) => {
                event.stopPropagation();
                handleThemeToggle();
            });

            // Start with SignIn Screen
            showAuthScreen('SignIn'); 
        });

    </script>
</body>
</html>